function openTab(e,t){var n,a,i;for($("html, body").animate({scrollTop:0},"slow"),a=document.getElementsByClassName("tab-content"),n=0;n<a.length;n++)a[n].style.display="none";for(i=document.getElementsByClassName("tab-button"),n=0;n<i.length;n++)i[n].className=i[n].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"}function isYear(e){return Number.isInteger(parseInt(e))}function isSelected(e){var t,n,a,i,r,o,l;return form=document.forms["main-form"],t="Všetky"==form.ministry.value||form.ministry.value==e.ministry,n="Všetky"==form.area.value||form.area.value==e.area,a="Všetky"==(o=document.querySelector('input[name="state"]:checked').value)||o==e.state,i="Všetky"==(l=document.querySelector('input[name="level"]:checked').value)||l==e.level,r=!0,isYear(form.start.value)&&isYear(form.finish.value)&&isYear(e.nominalStart)&&isYear(e.nominalFinish)&&(r=!1,console.log(form.finish.value+" - "+e.nominalFinish),console.log(form.start.value+" - "+e.nominalStart),parseInt(form.finish.value)>=parseInt(e.nominalFinish)&&parseInt(form.start.value)<=parseInt(e.nominalStart)&&(r=!0)),t&&n&&a&&i&&r}var dict={};function viewDetail(e){var t,n,a,i,r,o,l,s,c;for((t=document.getElementById("detail-table")).innerHTML="",r=["ministry","title","area","level","state","nominalStart","nominalFinish","parentLegislative","relatedDocument","annotation","note"],c=0;c<r.length;c++)a=r[c],(n=t.insertRow()).insertCell(0).innerHTML=dict[a],n.insertCell(1).innerHTML="relatedDocument"==a?'<a href = "'+e[a]+'">'+e[a]+"</a>":e[a];if("Aktuálna"==e.state||"Nevyužívaná"==e.state)for(o=["decreeNumber","approvalDate","reviewer","reviewForm","reviewFreq"],c=0;c<o.length;c++)a=o[c],(n=t.insertRow()).insertCell(0).innerHTML=dict[a],i=e[a],"decreeNumber"==a&&null!=i&&(i='<a href = "'+e.documentLink+'">'+i+"</a>"),n.insertCell(1).innerHTML=i;if("Nevyužívaná"==e.state)for(l=["terminationReason","successor","officialStart","cancellationProposal"],c=0;c<l.length;c++)a=l[c],(n=t.insertRow()).insertCell(0).innerHTML=dict[a],n.insertCell(1).innerHTML=e[a];if("Pripravovaná"==e.state)for(s=["preparationStart","preparationStatus","preparationFinish","approvingBody"],c=0;c<s.length;c++)a=s[c],(n=t.insertRow()).insertCell(0).innerHTML=dict[a],n.insertCell(1).innerHTML=e[a];document.getElementById("main-content").classList.add("activated-strategy");document.getElementById("detail-button").click()}dict.ministry="Rezort",dict.title="Názov strategického dokumentu",dict.area="Obsahové zameranie strategického dokumentu",dict.level="Úroveň platnosti strategického dokumentu",dict.state="Stav",dict.nominalStart="Platnosť od",dict.nominalFinish="Platnosť do",dict.parentLegislative="Podnet na vypracovanie materiálu",dict.relatedDocument="Súvisiaci dokument (nadradená stratégia alebo podriadený akčný plán)",dict.annotation="Anotácia dokumentu (textové pole)",dict.note="Poznámka k dokumentu",dict.decreeNumber="Číslo uznesenia",dict.documentLink="Odkaz na dokument",dict.approvalDate="Dátum schválenia",dict.reviewer="Vyhodnotenie plnenia strategického dokumentu (NR SR, vláda SR, ministerstvo)",dict.reviewForm="Forma vyhodnotenia a monitorovania strategického dokumentu",dict.reviewFreq="Opakovací cyklus vyhodnocovania strategického dokumentu",dict.terminationReason="Dôvod zastaranosti strategického dokumentu",dict.successor="Aktualizácia resp. nahradenie strategického dokumentu novým dokumentom",dict.officialStart="Termín kedy tento strategický dokument vstúpil do platnosti",dict.cancellationProposal="Návrhy na formálne zrušenie strategického dokumentu",dict.preparationStart="Termín začatia prác na strategickom dokumente",dict.preparationStatus="Štádium prípravy",dict.preparationFinish="Predpokladaný termín dopracovania";var hasBeen=!(dict.approvingBody="Spôsob schválenia (napr. vládou SR, vedením ministerstva)");function main(){var e,t,n,a,i,r,o,l,s,c,m;for((t=document.getElementById("search-table")).innerHTML="<tr><th>Id</th><th>Rezort</th><th>Názov</th><th>Obsah</th></tr>",n=excelFile,e=c=0;e<n.length;e++)isSelected(a=n[e])&&(r=(i=t.insertRow()).insertCell(0),o=i.insertCell(1),l=i.insertCell(2),s=i.insertCell(3),r.innerHTML=e,o.innerHTML=a.ministry,l.innerHTML=a.title,s.innerHTML=a.area,i.onclick=function(){var e;e=this.cells[0].innerHTML,viewDetail(n[e])},c+=1);m=1==c?c+" stratégia":2<=c&&c<=4?c+" stratégie":c+" stratégií",document.getElementById("result-count").innerHTML=m,hasBeen?$([document.documentElement,document.body]).animate({scrollTop:$("#search-table").offset().top-100},500):hasBeen=!0}